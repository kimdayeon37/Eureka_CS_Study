
# HTTP & HTTPS

### HTTP (HyperText Transfer Protocol)

- 인터넷 상에서 클라이언트와 서버가 자원을 주고받을 때 쓰는 통신 규약
- HTTP는 데이터를 암호화하지 않고 전송하여 전송 중에 데이터가 도청될 수 있다
- <em>→ HTTPS가 해결</em>

### HTTPS (HyperText Transfer Protocol Secure)

- SSL/TLS(전송 계층 보안) 프로토콜을 사용하여 데이터를 암호화한다
- 인증서를 사용하여 웹사이트의 신원을 확인하고, 사용자와 서버 간의 신뢰를 보장한다

<br/>

## TLS/SSL Handshake
- Handshake는 클라이언트(웹 브라우저)와 서버 간의 안전한 연결을 설정하는 과정
- HTTPS에서 클라이언트와 서버가 통신하기 전, SSL 인증서로 신뢰성 여부를 판단하기 위해 연결하는 방식
  - TLS(전송 계층 보안) 및 SSL(보안 소켓 계층)은 네트워크 통신을 암호화하는 프로토콜
- TLS는 SSL의 개선된 버전이며, 현재 대부분의 웹 보안 통신은 TLS를 사용함

### TLS/SSL Handshake Process
![](https://velog.velcdn.com/images/corinthionia/post/322a294b-f34d-468b-a9e9-604ebb965da5/image.png)

1. **클라이언트 헬로 (Client Hello)**
   - 클라이언트는 서버에 접속할 때 `Client Hello` 메시지를 보낸다
   - 이 메시지에는 클라이언트가 지원하는 TLS 버전, 암호화 방식, 세션 ID, 무작위 바이트(랜덤 데이터) 등이 포함된다
2. **서버 헬로 (Server Hello)**
   - 서버는 `Server Hello` 메시지로 응답한다
   - 이 메시지에는 서버가 선택한 TLS 버전, 암호화 방식, 세션 ID, 무작위 바이트 등이 포함된다
3. **서버 인증 및 키 교환**
   - 또한 서버는 자신의 인증서(CA 인증서)를 클라이언트에게 보낸다. 이 인증서는 클라이언트가 서버의 신원을 확인할 수 있게 한다.
   - 서버는 선택한 암호화 방식에 따라 공개 키를 클라이언트에게 보낼 수도 있다
4. **클라이언트 키 교환**
   - 클라이언트는 서버의 인증서를 확인하고 CA 인증서에 대한 신뢰성이 확보되었다면, 클라이언트는 **프리마스터 시크릿**을 생성하여 서버의 공개키로 암호화한다
   - `프리마스터 시크릿`은 TLS/SSL 핸드셰이크 과정에서 클라이언트와 서버가 공유하는 중요한 임시 데이터로, 이 데이터를 기반으로 세션 키를 생성하여 이후의 통신을 암호화한다
5. **세션 키 생성**
   - 서버는 자신의 개인 키로 프리마스터 시크릿을 복호화하여 세션 키를 생성한다
   - 클라이언트와 서버는 서로 공유한 프리마스터 시크릿을 바탕으로 동일한 세션 키를 생성한다
     - `세션 키(Session Key)` 특정 세션 동안 사용하는 일회성 대칭 키
6. **Client Finished**
   - 클라이언트는 `Finished` 메시지를 보내 Handshake 과정이 끝났음을 알린다. 이 메시지는 생성된 세션 키로 암호화된다.
   - 지금까지 보낸 교환 내역들을 해싱 후 그 값을 대칭키로 암호화하여 같이 담아 보내 준다
7. **Server Finished**
   - 서버도 동일하게 교환 내용들을 해싱한 뒤 클라이언트에서 보내준 값과 일치하는지 확인한다
   - 일치한다면 서버도 `Finished` 메시지를 보내 핸드셰이크 과정이 끝났음을 알린다 (이 메시지 또한 세션 키로 암호화된다)

### Handshake 이후

- 핸드셰이크 과정이 완료되면 클라이언트와 서버는 동일한 세션 키를 공유하게 된다. 이 세션 키를 사용하여 애플리케이션 데이터는 대칭 키 암호화를 통해 안전하게 전송된다.
